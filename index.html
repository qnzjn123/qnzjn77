<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¬´ì§€ê°œë‹¤ë¦¬ ì¶”ì–µì˜ ë¯¸ìˆ ê´€</title>
    <link rel="stylesheet" href="./styles.css">
    <style>
        /* ë¡œë”© ì¤‘ í‘œì‹œ */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 1.5em;
            z-index: 9999;
        }
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body tabindex="0" style="outline: none;">
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>ğŸŒˆ ë¯¸ìˆ ê´€ì„ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤... ğŸ•</p>
    </div>

    <div class="container" id="mainContent" style="display: none;">
        <header class="header">
            <h1>ğŸŒˆ ë¬´ì§€ê°œë‹¤ë¦¬ ì¶”ì–µì˜ ë¯¸ìˆ ê´€ ğŸ•</h1>
            <p>ì‚¬ë‘í•˜ëŠ” ë°˜ë ¤ê²¬ê³¼ì˜ ì†Œì¤‘í•œ ì¶”ì–µì„ 3D ë¯¸ìˆ ê´€ì—ì„œ ë§Œë‚˜ë³´ì„¸ìš”</p>
        </header>

        <div class="upload-section">
            <input type="file" id="photoUpload" accept="image/*" multiple>
            <label for="photoUpload" class="upload-btn">
                ğŸ“¸ ì¶”ì–µì˜ ì‚¬ì§„ ì˜¬ë¦¬ê¸°
            </label>
            <div class="photo-preview"></div>
        </div>

        <div class="gallery-container">
            <canvas id="gallery3d" tabindex="1" style="outline: none;"></canvas>
            <div class="controls">
                <div class="main-controls">
                    <button id="enterGallery">ğŸ›ï¸ ë¯¸ìˆ ê´€ ì…ì¥í•˜ê¸°</button>
                    <button id="resetView">ğŸ”„ ì²˜ìŒìœ¼ë¡œ</button>
                    <button id="testKeyboard" style="display: none;">í‚¤ë³´ë“œ í…ŒìŠ¤íŠ¸</button>
                </div>
                <div class="control-info">
                    <p>ğŸ–±ï¸ ë§ˆìš°ìŠ¤ ë“œë˜ê·¸: ì‹œì  íšŒì „ | íœ : ì¤Œ</p>
                    <p>âŒ¨ï¸ WASD: ì´ë™ | ìŠ¤í˜ì´ìŠ¤: ìœ„ë¡œ | Shift: ì•„ë˜ë¡œ</p>
                    <p id="keyStatus" style="font-size: 0.8em; color: #ffd700;"></p>
                </div>
            </div>
        </div>

        <div class="memorial-message">
            <p>ğŸŒŸ "ì‚¬ë‘ì€ ì˜ì›í•©ë‹ˆë‹¤. ì¶”ì–µ ì†ì—ì„œ ìš°ë¦¬ëŠ” ë‹¤ì‹œ ë§Œë‚  ìˆ˜ ìˆì–´ìš”." ğŸŒŸ</p>
        </div>
    </div>

    <script>
        // ì „ì—­ í•¨ìˆ˜ë“¤ì„ ë¨¼ì € ì •ì˜
        function handleScriptError() {
            console.error('Three.js ë¡œë”© ì‹¤íŒ¨');
            document.getElementById('loadingScreen').innerHTML = 
                '<p>ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.</p>';
        }
        
        function initializeGallery() {
            console.log('initializeGallery í˜¸ì¶œë¨');
            // Three.jsê°€ ë¡œë“œëœ í›„ gallery3d.js ë¡œë“œ
            const script = document.createElement('script');
            script.src = './gallery3d.js';
            script.onload = function() {
                console.log('gallery3d.js ë¡œë“œ ì™„ë£Œ');
                // ë¡œë”© í™”ë©´ ìˆ¨ê¸°ê¸°
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
            };
            script.onerror = function() {
                console.error('gallery3d.js ë¡œë”© ì‹¤íŒ¨');
                document.getElementById('loadingScreen').innerHTML = 
                    '<p>ê°¤ëŸ¬ë¦¬ ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
            };
            document.head.appendChild(script);
        }

        // DOM ë¡œë“œ ì™„ë£Œ í›„ Three.js ë¡œë“œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ë¡œë“œ ì™„ë£Œ, Three.js ë¡œë”© ì‹œì‘');
            
            // Three.js ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
            const threeScript = document.createElement('script');
            threeScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js';
            threeScript.crossOrigin = 'anonymous';
            threeScript.onload = function() {
                console.log('Three.js ë¡œë“œ ì™„ë£Œ');
                initializeGallery();
            };
            threeScript.onerror = function() {
                handleScriptError();
            };
            document.head.appendChild(threeScript);
        });
    </script>
</body>
</html>
